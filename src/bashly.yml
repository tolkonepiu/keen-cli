name: keen-cli
help: Keenetic command-line interface written in Bash
version: 0.0.1

dependencies:
  curl: https://curl.se/
  yq: https://mikefarah.gitbook.io/yq/
  md5:
    command: [md5sum, md5]

environment_variables:
  - name: KEENETIC_USERNAME
    help: Keenetic username
    required: true
  - name: KEENETIC_PASSWORD
    help: Keenetic password
    required: true

commands:
  - name: login
    help: Log in to a Keenetic router

    flags:
      - &host
        long: --host
        short: -h
        arg: host
        help: Host name
        default: 192.168.1.1
      - &port
        long: --port
        short: -p
        arg: port
        help: Port number
      - &scheme
        long: --scheme
        short: -s
        arg: scheme
        help: URL scheme
        default: http
        allowed:
          - http
          - https

    examples:
      - keenclient login --host 192.168.0.1 --port 8080
      - keenclient login -s https --host myrouter01.keenetic.link

  - name: request
    help: Make a http-request to a Keenetic router

    args:
      - name: url_path
        help: URL path (example `/rci/show/system/`)
        required: true
      - name: request_data
        help: Request data (if the request_data parameter is specified, a POST request will be made)
        required: false
        validate: json

    flags:
      - *host
      - *port
      - *scheme
      - long: --output
        short: -o
        arg: output
        help: Write to file instead of stdout
        validate: file_path
      - long: --format
        short: -f
        arg: format
        allowed:
          - json
          - yaml
          - xml
          - props
      - long: --verbose
        help: Make the client more talkative

    examples:
      - keenclient request /rci/
      - keenclient request -p 8080 --verbose /rci/
      - keenclient request -f yaml -o /tmp/dump /rci/
      - keenclient request -s https --host myrouter01.keenetic.link /rci/
      - >-
        keenclient request
        -s https
        --host
        myrouter01.keenetic.link
        /rci/
        '[{"show":{"interface":{}}}]'
